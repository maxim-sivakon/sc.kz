{"version":3,"file":"script.js","sources":["src/workflow-loader.js","src/workflow-renderer.js","src/counter-panel.js","src/user-processes.js"],"sourcesContent":["import { TaskControls } from 'bizproc.task';\nimport { WorkflowId } from 'bizproc.types';\nimport { ajax } from 'main.core';\n\nexport type LoadWorkflowsResponseData = {\n\tdata: {\n\t\tworkflows: Array<WorkflowData>,\n\t},\n};\n\nexport type WorkflowData = {\n\tworkflowId: string,\n\tuserId: number,\n\tstartedById: number,\n\tstartedBy?: string,\n\ttaskProgress: {},\n\tname: string,\n\tdescription: string,\n\ttypeName: string,\n\tstatusText: string,\n\tmodified: string,\n\ttemplateName?: string,\n\tworkflowStarted: string,\n\tdocument: {\n\t\turl?: string,\n\t\tname: string,\n\t},\n\ttask: Partial<{\n\t\tid: number,\n\t\tname: string,\n\t\tdescription: string,\n\t\turl: string,\n\t\tusers: Array<{ id: number, status: number }>,\n\t\tstatus: number | string,\n\t\tcontrols: TaskControls,\n\t\tapproveType: string,\n\t\tcomments: number,\n\t\tmodified: string,\n\t\tmodifiedDate: number,\n\t\toverdueDate: string,\n\t}>,\n\ttaskCnt: number,\n\tcommentCnt: number,\n\tisCompleted: boolean,\n\tworkflowUrl: ?string,\n};\n\nexport class WorkflowLoader\n{\n\tloadWorkflows(ids: WorkflowId[]): Promise<LoadWorkflowsResponseData, Array<{ message: string }>>\n\t{\n\t\treturn this.#runComponentAction('loadWorkflows', { ids });\n\t}\n\n\t#runComponentAction(action: string, data: Object = {}): Promise\n\t{\n\t\treturn new Promise((resolve, reject) => {\n\t\t\tajax.runComponentAction('bitrix:bizproc.user.processes', action, {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata,\n\t\t\t}).catch((response) => {\n\t\t\t\treject(response);\n\t\t\t}).then((response) => {\n\t\t\t\tresolve(response);\n\t\t\t});\n\t\t});\n\t}\n}\n","import { Text, Tag, Type, Dom, Uri, Loc } from 'main.core';\nimport { Task, InlineTaskView } from 'bizproc.task';\nimport type { UserProcesses } from './user-processes';\nimport { WorkflowData } from './workflow-loader';\nimport { WorkflowFaces } from 'bizproc.workflow.faces';\nimport { Summary } from 'bizproc.workflow.faces.summary';\nimport { Counter, CounterColor } from 'ui.cnt';\n\nexport class WorkflowRenderer\n{\n\t#currentUserId: number;\n\t#targetUserId: ?number;\n\t#data: WorkflowData;\n\t#task: Task;\n\t#inlineTaskView: InlineTaskView;\n\t#faces: ?WorkflowFaces = null;\n\n\tconstructor(data: {\n\t\tuserProcesses: UserProcesses,\n\t\tcurrentUserId: number,\n\t\tworkflow: WorkflowData,\n\t})\n\t{\n\t\tthis.#data = data.workflow;\n\t\tthis.#currentUserId = Type.isNumber(data.currentUserId) ? data.currentUserId : 0;\n\t\tthis.#targetUserId = this.#data.userId;\n\n\t\tif (this.#data.task)\n\t\t{\n\t\t\tthis.#task = new Task(this.#data.task);\n\t\t\tif (Type.isArrayFilled(this.#task.controls.buttons))\n\t\t\t{\n\t\t\t\tthis.#task.setButtons(\n\t\t\t\t\tthis.#task.buttons.map((button) => ({\n\t\t\t\t\t\tonclick: () => data.userProcesses.doTask({\n\t\t\t\t\t\t\ttaskId: this.#task.id,\n\t\t\t\t\t\t\tworkflowId: this.#data.workflowId,\n\t\t\t\t\t\t\ttaskName: this.#task.name,\n\t\t\t\t\t\t\ttaskRequest: {\n\t\t\t\t\t\t\t\t[button.NAME]: button.VALUE,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t}),\n\t\t\t\t\t\t...button,\n\t\t\t\t\t})),\n\t\t\t\t);\n\t\t\t}\n\t\t\tthis.#inlineTaskView = new InlineTaskView({\n\t\t\t\ttask: this.#task,\n\t\t\t\tresponsibleUser: this.#targetUserId,\n\t\t\t});\n\t\t}\n\t}\n\n\trenderProcess(): HTMLElement | string\n\t{\n\t\tconst itemName = Type.isString(this.#data?.name) ? this.#data.name : '';\n\t\tconst typeName = Type.isString(this.#data?.typeName) ? this.#data.typeName : '';\n\t\tconst documentUrl = this.#data.task?.url || this.#data.workflowUrl || this.#getWorkflowInfoUrl();\n\n\t\tconst description = Type.isString(this.#data?.description) ? this.#data.description : '';\n\t\tconst lengthLimit = 80;\n\t\tconst collapsedDescription = Dom.create('span', { html: description?.replace(/(<br \\/>)+/gm, ' ') }).textContent.replace(/\\n+/, ' ').slice(0, lengthLimit);\n\t\tconst collapsed = description?.length > lengthLimit;\n\n\t\treturn Tag.render`\n\t\t\t\t<div class=\"bp-user-processes\">\n\t\t\t\t\t<a class=\"bp-user-processes__title-link ui-typography-text-lg\"\n\t\t\t\t\t\thref=\"${Text.encode(documentUrl)}\">${Text.encode(itemName)}\n\t\t\t\t\t</a>\n\t\t\t\t\t<div class=\"bp-user-processes__appointment\">${Text.encode(typeName.toUpperCase())}</div>\n\t\t\t\t\t<div class=\"bp-user-processes__description-box ${collapsed ? '' : '--expanded'}\">\n\t\t\t\t\t\t<span class=\"bp-user-processes__short_description\">\n\t\t\t\t\t\t\t${Text.encode(collapsedDescription)}\n\t\t\t\t\t\t\t...<a href=\"#\" onclick=\"this.closest('div').classList.add('--expanded'); return false;\" class=\"bp-user-processes__description-link\">${Loc.getMessage('BIZPROC_USER_PROCESSES_TEMPLATE_DESCRIPTION_MORE')}</a>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class=\"bp-user-processes__description\">\n\t\t\t\t\t\t\t${description}\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</div>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\t#getWorkflowInfoUrl(): string\n\t{\n\t\tconst idParam = Type.isNil(this.#data.task?.id) ? this.#data.workflowId : this.#data.task.id;\n\t\tconst uri = new Uri(`/company/personal/bizproc/${idParam}/`);\n\n\t\treturn uri.toString();\n\t}\n\n\trenderTaskName(): ?HTMLElement\n\t{\n\t\treturn this.#inlineTaskView?.render();\n\t}\n\n\trenderTask(): ?HTMLElement\n\t{\n\t\tif (!this.#data.task || this.#data.userId !== this.#currentUserId)\n\t\t{\n\t\t\tconst completedClassName = this.#data.isCompleted ? '--success' : '';\n\n\t\t\treturn Tag.render`\n\t\t\t\t<div class=\"bp-status-panel ${completedClassName}\">\n\t\t\t\t\t\t<div class=\"bp-status-item\">\n\t\t\t\t\t\t\t<div class=\"bp-status-name\">${Text.encode(this.#data.statusText.toUpperCase())}</div>\n\t\t\t\t\t\t\t${''/* completedClassName ? '' : '<div class=\"ui-icon-set --help bp-status-icon\"></div>' */}\n\t\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t`;\n\t\t}\n\n\t\treturn this.renderTaskName();\n\t}\n\n\trenderDocumentName(): HTMLElement\n\t{\n\t\tconst documentName = Type.isString(this.#data?.document?.name) ? this.#data.document.name : '';\n\n\t\tif (Type.isString(this.#data?.document?.url))\n\t\t{\n\t\t\tconst url = new Uri(this.#data.document.url);\n\n\t\t\treturn Tag.render`\n\t\t\t\t<a href=\"${Text.encode(url.toString())}\">\n\t\t\t\t\t${Text.encode(documentName)}\n\t\t\t\t</a>\n\t\t\t`;\n\t\t}\n\n\t\treturn Text.encode(documentName);\n\t}\n\n\trenderWorkflowFaces(): HTMLElement\n\t{\n\t\tconst target = Tag.render`<div></div>`;\n\n\t\tthis.#faces = (new WorkflowFaces({\n\t\t\tworkflowId: this.#data.workflowId,\n\t\t\ttargetUserId: this.#targetUserId,\n\t\t\ttarget,\n\t\t\tdata: this.#data.taskProgress,\n\t\t\tshowArrow: true,\n\t\t}));\n\t\tthis.#faces.render();\n\n\t\treturn target;\n\t}\n\n\trenderSummary(): HTMLElement\n\t{\n\t\treturn (\n\t\t\t(new Summary({\n\t\t\t\tworkflowId: this.#data.workflowId,\n\t\t\t\ttime: this.#data.taskProgress.time.total,\n\t\t\t\tworkflowIsCompleted: this.#data.taskProgress.workflowIsCompleted,\n\t\t\t\tshowArrow: false,\n\t\t\t})\n\t\t\t).render()\n\t\t);\n\t}\n\n\trenderModified(): HTMLElement\n\t{\n\t\tlet counter = null;\n\t\tif (this.#data.userId === this.#currentUserId && (this.#data.taskCnt > 0 || this.#data.commentCnt > 0))\n\t\t{\n\t\t\tconst primaryColor = this.#data.taskCnt === 0 && this.#data.commentCnt > 0\n\t\t\t\t? CounterColor.SUCCESS\n\t\t\t\t: CounterColor.DANGER\n\t\t\t;\n\n\t\t\tcounter = new Counter({\n\t\t\t\tvalue: (this.#data.taskCnt || 0) + (this.#data.commentCnt || 0),\n\t\t\t\tcolor: primaryColor,\n\t\t\t\tsecondaryColor: CounterColor.SUCCESS,\n\t\t\t\tisDouble: this.#data.taskCnt > 0 && this.#data.commentCnt > 0,\n\t\t\t});\n\t\t}\n\n\t\treturn Tag.render`\n\t\t\t<div class=\"bp-modified-cell\">\n\t\t\t\t<span class=\"bp-row-counters\">${counter?.getContainer()}</span>\n\t\t\t\t<span>${Text.encode(this.#data.modified)}</span>\n\t\t\t</div>\n\t\t`;\n\t}\n\n\tdestroy()\n\t{\n\t\tthis.#data = null;\n\t\tthis.#task = null;\n\t\tthis.#inlineTaskView = null;\n\n\t\tif (!Type.isNil(this.#faces))\n\t\t{\n\t\t\tthis.#faces.destroy();\n\t\t\tthis.#faces = null;\n\t\t}\n\t}\n}\n","import { Loc } from 'main.core';\n\ntype Counters = {\n\ttask: number,\n\tcomment: number,\n}\n\nexport class CounterPanel\n{\n\tfilterId: string;\n\tcounters: Counters;\n\tuiPanel;\n\n\tconstructor(options: {\n\t\tfilterId: string,\n\t\tcounters: Counters,\n\t})\n\t{\n\t\tthis.filterId = options.filterId;\n\t\tthis.counters = options.counters;\n\t}\n\n\trenderTo(target: HTMLElement)\n\t{\n\t\tthis.uiPanel = new BX.UI.CounterPanel({\n\t\t\ttarget,\n\t\t\tmultiselect: false,\n\t\t\ttitle: Loc.getMessage('BIZPROC_USER_PROCESSES_TEMPLATE_COUNTERS_LABEL'),\n\t\t\titems: [\n\t\t\t\t{\n\t\t\t\t\tid: 'task',\n\t\t\t\t\tvalue: {\n\t\t\t\t\t\tvalue: this.counters?.task || 0,\n\t\t\t\t\t\torder: 1,\n\t\t\t\t\t},\n\t\t\t\t\ttitle: {\n\t\t\t\t\t\tvalue: Loc.getMessage('BIZPROC_USER_PROCESSES_TEMPLATE_COUNTERS_TASK'),\n\t\t\t\t\t\torder: 2,\n\t\t\t\t\t},\n\t\t\t\t\tcolor: this.#getTaskColor(this.counters?.task),\n\t\t\t\t\tseparator: false,\n\t\t\t\t\teventsForActive: {\n\t\t\t\t\t\tclick: this.#setFilterPreset.bind(this),\n\t\t\t\t\t},\n\t\t\t\t\teventsForUnActive: {\n\t\t\t\t\t\tclick: this.#setFilterPreset.bind(this, 'active_task'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\t{\n\t\t\t\t\tid: 'comment',\n\t\t\t\t\tvalue: this.counters?.comment || 0,\n\t\t\t\t\ttitle: Loc.getMessage('BIZPROC_USER_PROCESSES_TEMPLATE_COUNTERS_COMMENT'),\n\t\t\t\t\tcolor: this.#getCommentColor(this.counters?.comment),\n\t\t\t\t\teventsForActive: {\n\t\t\t\t\t\tclick: this.#setFilterPreset.bind(this),\n\t\t\t\t\t},\n\t\t\t\t\teventsForUnActive: {\n\t\t\t\t\t\tclick: this.#setFilterPreset.bind(this, 'comment'),\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t],\n\t\t});\n\n\t\tthis.uiPanel.init();\n\t\tthis.#subscribeToPulls();\n\t}\n\n\t#subscribeToPulls()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\tmoduleId: 'main',\n\t\t\tcommand: 'user_counter',\n\t\t\tcallback: (params) => {\n\t\t\t\tconst taskCounterValue = (params[BX.message('SITE_ID')])?.bp_tasks ?? null;\n\t\t\t\tif (taskCounterValue !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.uiPanel.getItemById('task').updateValue(taskCounterValue);\n\t\t\t\t\tthis.uiPanel.getItemById('task').updateColor(this.#getTaskColor(taskCounterValue));\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\n\t\tBX.PULL.subscribe({\n\t\t\tmoduleId: 'bizproc',\n\t\t\tcommand: 'comment',\n\t\t\tcallback: (params) => {\n\t\t\t\tconst allUnreadValue: number | null = params.counter?.allUnread ?? null;\n\n\t\t\t\tif (allUnreadValue !== null)\n\t\t\t\t{\n\t\t\t\t\tthis.uiPanel.getItemById('comment').updateValue(allUnreadValue);\n\t\t\t\t\tthis.uiPanel.getItemById('comment').updateColor(this.#getCommentColor(allUnreadValue));\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t#getTaskColor(value): string\n\t{\n\t\treturn value > 0 ? 'DANGER' : 'THEME';\n\t}\n\n\t#getCommentColor(value): string\n\t{\n\t\treturn value > 0 ? 'SUCCESS' : 'THEME';\n\t}\n\n\t#setFilterPreset(presetId: string): void\n\t{\n\t\tconst filterManager = this.#getFilterManager();\n\t\tif (!filterManager)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst api = filterManager.getApi();\n\t\tconst fields = {\n\t\t\tSYSTEM_PRESET: presetId ?? 'in_work',\n\t\t};\n\n\t\tapi.setFields(fields);\n\t\tapi.apply();\n\t}\n\n\t#getFilterManager(): ?BX.Main.Filter\n\t{\n\t\tif (this.filterId)\n\t\t{\n\t\t\treturn BX.Main.filterManager?.getById(this.filterId);\n\t\t}\n\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.warn('Filter not found');\n\n\t\treturn null;\n\t}\n}\n","import { ajax, Type, Dom, Tag, Text, Loc, Event, Runtime } from 'main.core';\nimport { Alert, AlertColor } from 'ui.alerts';\nimport { TagSelector } from 'ui.entity-selector';\nimport { Menu } from 'main.popup';\nimport type { WorkflowData } from './workflow-loader';\nimport { WorkflowLoader, LoadWorkflowsResponseData } from './workflow-loader';\nimport { WorkflowRenderer } from './workflow-renderer';\nimport { CounterPanel } from './counter-panel.js';\nimport { UI } from 'ui.notification';\n\nimport './style.css';\n\nimport 'ui.design-tokens';\n\ntype WorkflowId = string;\ntype TaskId = number;\n\nexport class UserProcesses\n{\n\tgridId: string;\n\tdelegateToSelector: TagSelector;\n\tdelegateToUserId: number = 0;\n\tactionPanel: {\n\t\twrapperElementId: string,\n\t\tactionButtonName: string,\n\t\tuserWrapperElement: ?HTMLElement,\n\t};\n\n\t#workflowTasks: Map<WorkflowId, TaskId> = new Map();\n\t#workflowRenderer: Object<WorkflowId, WorkflowRenderer> = {};\n\tcurrentUserId: number;\n\n\tloader: WorkflowLoader;\n\n\tconstructor(options: {\n\t\tgridId: string,\n\t\tactionPanelUserWrapperId: string,\n\t\terrors: Array<{ message: string }>,\n\t\tcurrentUserId: number,\n\t\tmustSubscribeToPushes: boolean,\n\t})\n\t{\n\t\tlet mustSubscribeToPushes = false;\n\n\t\tif (Type.isPlainObject(options))\n\t\t{\n\t\t\tthis.gridId = options.gridId;\n\n\t\t\tif (Type.isArray(options.errors))\n\t\t\t{\n\t\t\t\tthis.showErrors(options.errors);\n\t\t\t}\n\t\t\tthis.actionPanel = {\n\t\t\t\twrapperElementId: options.actionPanelUserWrapperId,\n\t\t\t\tactionButtonName: `${this.gridId}_action_button`,\n\t\t\t};\n\n\t\t\tthis.currentUserId = options.currentUserId;\n\n\t\t\tmustSubscribeToPushes = options.mustSubscribeToPushes === true;\n\t\t}\n\n\t\tthis.loader = new WorkflowLoader();\n\n\t\tif (mustSubscribeToPushes)\n\t\t{\n\t\t\tthis.#subscribeToPushes();\n\t\t}\n\n\t\tthis.init();\n\t\tthis.initCounterPanel(options.counters, options.filterId);\n\t}\n\n\t#subscribeToPushes()\n\t{\n\t\tBX.PULL.subscribe({\n\t\t\tmoduleId: 'bizproc',\n\t\t\tcommand: 'workflow',\n\t\t\tcallback: (params) => {\n\t\t\t\tif (params.eventName === 'DELETED' || params.eventName === 'UPDATED')\n\t\t\t\t{\n\t\t\t\t\tparams.items.forEach((workflow) => this.removeWorkflow(workflow.id));\n\t\t\t\t}\n\n\t\t\t\tif (params.eventName === 'ADDED' || params.eventName === 'UPDATED')\n\t\t\t\t{\n\t\t\t\t\tconst rowsCollectionWrapper: BX.Grid.Rows = this.getGrid().getRows();\n\t\t\t\t\tlet ids = params.items.map((workflow) => workflow.id);\n\t\t\t\t\tif (params.eventName === 'ADDED')\n\t\t\t\t\t{\n\t\t\t\t\t\tids = ids.filter((id) => !rowsCollectionWrapper.getById(id));\n\t\t\t\t\t}\n\n\t\t\t\t\tif (ids.length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.loader\n\t\t\t\t\t\t\t.loadWorkflows(ids)\n\t\t\t\t\t\t\t.then(this.#updateWorkflows.bind(this))\n\t\t\t\t\t\t\t.catch((response) => this.showErrors(response))\n\t\t\t\t\t\t;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t},\n\t\t});\n\t}\n\n\t#updateWorkflows(response: LoadWorkflowsResponseData): void\n\t{\n\t\tconst { workflows } = response.data;\n\t\tif (!Type.isArray(workflows))\n\t\t{\n\t\t\t// eslint-disable-next-line no-console\n\t\t\tconsole.warn('Unexpected response from server. Expected workflow.data to be an array');\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst gridRealtime = this.getGrid()?.getRealtime();\n\n\t\tif (gridRealtime)\n\t\t{\n\t\t\tlet lastWorkflowId = null;\n\t\t\tworkflows.forEach((workflow) => {\n\t\t\t\tconst isActual = Boolean(\n\t\t\t\t\tworkflow.taskCnt > 0\n\t\t\t\t\t|| workflow.commentCnt > 0\n\t\t\t\t\t|| (\n\t\t\t\t\t\tworkflow.startedById === this.currentUserId\n\t\t\t\t\t\t&& workflow.isCompleted === false\n\t\t\t\t\t),\n\t\t\t\t);\n\n\t\t\t\tif (isActual)\n\t\t\t\t{\n\t\t\t\t\tthis.#appendWorkflow({\n\t\t\t\t\t\tworkflow,\n\t\t\t\t\t\trenderer: this.#createWorkflowRenderer(workflow.workflowId, workflow),\n\t\t\t\t\t\tinsertAfter: lastWorkflowId,\n\t\t\t\t\t});\n\t\t\t\t\tlastWorkflowId = workflow.workflowId;\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\t#appendWorkflow({ workflow, renderer, insertAfter }): void\n\t{\n\t\tif (workflow.task)\n\t\t{\n\t\t\tthis.#workflowTasks.set(workflow.workflowId, workflow.task.id);\n\t\t}\n\n\t\tconst gridRealtime = this.getGrid()?.getRealtime();\n\t\tif (!gridRealtime)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\tconst addRowOptions = this.getDefaultAddRowOptions(workflow, renderer);\n\n\t\tif (Type.isStringFilled(insertAfter))\n\t\t{\n\t\t\taddRowOptions.insertAfter = insertAfter;\n\t\t}\n\t\telse\n\t\t{\n\t\t\taddRowOptions.prepend = true;\n\t\t}\n\n\t\tgridRealtime.addRow(addRowOptions);\n\n\t\t// temporary crutches for the GRID :-)\n\t\tconst row: BX.Grid.Row = this.getGrid()?.getRows().getById(workflow.workflowId);\n\t\tif (row)\n\t\t{\n\t\t\tif (addRowOptions.columnClasses)\n\t\t\t{\n\t\t\t\tfor (const [columnId, columnClass] of Object.entries(addRowOptions.columnClasses))\n\t\t\t\t{\n\t\t\t\t\tif (columnClass)\n\t\t\t\t\t{\n\t\t\t\t\t\tDom.addClass(row.getCellById(columnId), columnClass);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tDom.addClass(row.getNode(), 'main-ui-grid-show-new-row');\n\t\t\tEvent.bind(row.getNode(), 'animationend', (event: AnimationEvent) => {\n\t\t\t\tif (event.animationName === 'showNewRow')\n\t\t\t\t{\n\t\t\t\t\tDom.removeClass(row.getNode(), 'main-ui-grid-show-new-row');\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t}\n\n\tgetDefaultAddRowOptions(workflow: WorkflowData, renderer: WorkflowRenderer): Object\n\t{\n\t\tconst actions = [\n\t\t\t{\n\t\t\t\ttext: Loc.getMessage('BIZPROC_USER_PROCESSES_TEMPLATE_ROW_ACTION_DOCUMENT'),\n\t\t\t\thref: workflow.document.url || '#',\n\t\t\t},\n\t\t];\n\n\t\tif (workflow.task)\n\t\t{\n\t\t\tactions.push({\n\t\t\t\ttext: Loc.getMessage('BIZPROC_USER_PROCESSES_TEMPLATE_ROW_ACTION_TASK'),\n\t\t\t\thref: workflow.task.url,\n\t\t\t});\n\t\t}\n\n\t\treturn {\n\t\t\tid: workflow.workflowId,\n\t\t\tanimation: false,\n\t\t\tcolumns: {\n\t\t\t\tID: workflow.workflowId,\n\t\t\t\tPROCESS: renderer.renderProcess(),\n\t\t\t\tTASK_PROGRESS: renderer.renderWorkflowFaces(),\n\t\t\t\tTASK: renderer.renderTask(),\n\t\t\t\tWORKFLOW_STATE: Text.encode(workflow.statusText),\n\t\t\t\tDOCUMENT_NAME: renderer.renderDocumentName(),\n\t\t\t\tWORKFLOW_TEMPLATE_NAME: Text.encode(workflow.templateName),\n\t\t\t\tTASK_DESCRIPTION: Dom.create('span', { html: workflow.description || '' }),\n\t\t\t\tMODIFIED: renderer.renderModified(),\n\t\t\t\tWORKFLOW_STARTED: Text.encode(workflow.workflowStarted),\n\t\t\t\tWORKFLOW_STARTED_BY: Text.encode(workflow.startedBy),\n\t\t\t\tOVERDUE_DATE: Text.encode(workflow.overdueDate),\n\t\t\t\tSUMMARY: renderer.renderSummary(),\n\t\t\t},\n\t\t\tactions,\n\t\t\tcolumnClasses: {\n\t\t\t\tTASK_PROGRESS: 'bp-task-progress-cell',\n\t\t\t\tSUMMARY: 'bp-summary-cell',\n\t\t\t\tTASK: workflow.isCompleted ? 'bp-status-completed-cell' : '',\n\t\t\t},\n\t\t\teditable: Boolean(workflow.task),\n\t\t};\n\t}\n\n\tinit(): void\n\t{\n\t\tthis.actionPanel.userWrapperElement = document.getElementById(this.actionPanel.wrapperElementId);\n\t\tthis.initUserSelector();\n\t\tthis.renderCells();\n\n\t\tthis.onActionPanelChanged();\n\t}\n\n\tinitCounterPanel(counters, filterId): void\n\t{\n\t\tconst panelWrapperNode = document.querySelector('[data-role=\"bizproc-counterpanel\"]');\n\t\tif (!panelWrapperNode)\n\t\t{\n\t\t\treturn;\n\t\t}\n\n\t\t(new CounterPanel({ counters, filterId })).renderTo(panelWrapperNode);\n\t}\n\n\trenderCells()\n\t{\n\t\tconst updated = new Map();\n\n\t\tdocument.querySelectorAll('[data-role=\"bp-render-cell\"]').forEach(\n\t\t\t(target) => {\n\t\t\t\tconst workflow = Dom.attr(target, 'data-workflow');\n\t\t\t\tconst columnId = Dom.attr(target, 'data-column');\n\n\t\t\t\tif (workflow)\n\t\t\t\t{\n\t\t\t\t\tif (!updated.has(workflow.workflowId))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.#deleteWorkflowRendererById(workflow.workflowId);\n\t\t\t\t\t\tupdated.set(workflow.workflowId);\n\t\t\t\t\t}\n\n\t\t\t\t\tif (workflow.task)\n\t\t\t\t\t{\n\t\t\t\t\t\t// set workflow task map\n\t\t\t\t\t\tthis.#workflowTasks.set(workflow.workflowId, workflow.task.id);\n\t\t\t\t\t}\n\n\t\t\t\t\tthis.renderColumnCell(target, columnId, workflow);\n\t\t\t\t}\n\t\t\t},\n\t\t);\n\t}\n\n\trenderColumnCell(target, columnId, workflow)\n\t{\n\t\tconst renderer = (\n\t\t\tthis.#getWorkflowRendererById(String(workflow.workflowId))\n\t\t\t?? this.#createWorkflowRenderer(String(workflow.workflowId), workflow)\n\t\t);\n\n\t\tlet childNode = null;\n\t\tswitch (columnId)\n\t\t{\n\t\t\tcase 'DOCUMENT_NAME':\n\t\t\t\tchildNode = renderer.renderDocumentName();\n\t\t\t\tbreak;\n\n\t\t\tcase 'PROCESS':\n\t\t\t\tchildNode = renderer.renderProcess();\n\t\t\t\tbreak;\n\n\t\t\tcase 'TASK_PROGRESS':\n\t\t\t\tchildNode = renderer.renderWorkflowFaces();\n\t\t\t\tbreak;\n\n\t\t\tcase 'TASK':\n\t\t\t\tchildNode = renderer.renderTask();\n\t\t\t\tbreak;\n\n\t\t\tcase 'SUMMARY':\n\t\t\t\tchildNode = renderer.renderSummary();\n\t\t\t\tbreak;\n\n\t\t\tcase 'MODIFIED':\n\t\t\t\tchildNode = renderer.renderModified();\n\t\t\t\tbreak;\n\n\t\t\tdefault:\n\t\t\t\t// do nothing\n\t\t}\n\n\t\tif (childNode)\n\t\t{\n\t\t\tDom.replace(\n\t\t\t\ttarget,\n\t\t\t\tchildNode,\n\t\t\t);\n\t\t}\n\t}\n\n\tasync initStartWorkflowButton(buttonId: ?string)\n\t{\n\t\tconst button = Type.isStringFilled(buttonId) && document.getElementById(buttonId);\n\t\tconst lists = Type.isStringFilled(button?.dataset.lists) && JSON.parse(button.dataset.lists);\n\t\tlet selectedIBlockSliderParams = null;\n\n\t\tif (lists)\n\t\t{\n\t\t\tconst popupMenu = new Menu({\n\t\t\t\tangle: true,\n\t\t\t\toffsetLeft: Dom.getPosition(button).width / 2,\n\t\t\t\tautoHide: true,\n\t\t\t\tbindElement: button,\n\t\t\t\tcloseByEsc: true,\n\t\t\t\titems: Object.values(lists).map((list) => {\n\t\t\t\t\tconst item = {\n\t\t\t\t\t\ttext: list.name,\n\t\t\t\t\t\tclassName: 'feed-add-post-form-link-lists',\n\t\t\t\t\t\tdataset: {\n\t\t\t\t\t\t\ticonUrl: list.icon,\n\t\t\t\t\t\t},\n\t\t\t\t\t};\n\n\t\t\t\t\tif (Type.isNil(list.url))\n\t\t\t\t\t{\n\t\t\t\t\t\tconst params = {\n\t\t\t\t\t\t\tiBlockTypeId: list.iBlockTypeId,\n\t\t\t\t\t\t\tiBlockId: list.iBlockId,\n\t\t\t\t\t\t\tanalyticsP1: list.name,\n\t\t\t\t\t\t};\n\n\t\t\t\t\t\tif (list.selected === true)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tselectedIBlockSliderParams = params;\n\t\t\t\t\t\t}\n\n\t\t\t\t\t\titem.onclick = () => {\n\t\t\t\t\t\t\tpopupMenu.close();\n\t\t\t\t\t\t\tRuntime.loadExtension('lists.element.creation-guide')\n\t\t\t\t\t\t\t\t.then(({ CreationGuide }) => {\n\t\t\t\t\t\t\t\t\tCreationGuide?.open(params);\n\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t\t\t;\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t\telse\n\t\t\t\t\t{\n\t\t\t\t\t\titem.href = list.url;\n\t\t\t\t\t}\n\n\t\t\t\t\treturn item;\n\t\t\t\t}),\n\t\t\t});\n\t\t\tconst popupElement = popupMenu.getMenuContainer();\n\t\t\tfor (const iconElement of popupElement.querySelectorAll('.menu-popup-item-icon'))\n\t\t\t{\n\t\t\t\tDom.append(\n\t\t\t\t\tTag.render`\n\t\t\t\t\t\t<img src = \"${iconElement.parentElement.dataset.iconUrl}\" alt=\"\" width = \"19\" height = \"16\"/>\n\t\t\t\t\t`,\n\t\t\t\t\ticonElement,\n\t\t\t\t);\n\t\t\t}\n\n\t\t\tbutton.onclick = (event) => {\n\t\t\t\tevent.preventDefault();\n\t\t\t\tif (!popupMenu.getPopupWindow().isShown())\n\t\t\t\t{\n\t\t\t\t\tRuntime.loadExtension('ui.analytics')\n\t\t\t\t\t\t.then(({ sendData }) => {\n\t\t\t\t\t\t\tsendData({\n\t\t\t\t\t\t\t\ttool: 'automation',\n\t\t\t\t\t\t\t\tcategory: 'bizproc_operations',\n\t\t\t\t\t\t\t\tevent: 'drawer_open',\n\t\t\t\t\t\t\t\tc_section: 'bizproc',\n\t\t\t\t\t\t\t\tc_element: 'button',\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t})\n\t\t\t\t\t\t.catch(() => {})\n\t\t\t\t\t;\n\t\t\t\t}\n\t\t\t\tpopupMenu.toggle();\n\t\t\t};\n\t\t}\n\n\t\tif (selectedIBlockSliderParams)\n\t\t{\n\t\t\tRuntime.loadExtension('lists.element.creation-guide')\n\t\t\t\t.then(({ CreationGuide }) => {\n\t\t\t\t\tCreationGuide?.open(selectedIBlockSliderParams);\n\t\t\t\t})\n\t\t\t\t.catch(() => {})\n\t\t\t;\n\t\t}\n\t}\n\n\tinitUserSelector(): void\n\t{\n\t\tif (!this.delegateToSelector)\n\t\t{\n\t\t\tthis.delegateToSelector = new TagSelector({\n\t\t\t\tmultiple: false,\n\t\t\t\ttagMaxWidth: 180,\n\t\t\t\tevents: {\n\t\t\t\t\tonTagAdd: (event) => {\n\t\t\t\t\t\tthis.delegateToUserId = parseInt(event.getData().tag.getId(), 10);\n\n\t\t\t\t\t\tif (!Type.isInteger(this.delegateToUserId))\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tthis.delegateToUserId = 0;\n\t\t\t\t\t\t}\n\t\t\t\t\t},\n\t\t\t\t\tonTagRemove: () => {\n\t\t\t\t\t\tthis.delegateToUserId = 0;\n\t\t\t\t\t},\n\t\t\t\t},\n\t\t\t\tdialogOptions: {\n\t\t\t\t\tentities: [\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tid: 'user',\n\t\t\t\t\t\t\toptions: {\n\t\t\t\t\t\t\t\tintranetUsersOnly: true,\n\t\t\t\t\t\t\t\tinviteEmployeeLink: false,\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t},\n\t\t\t\t\t],\n\t\t\t\t},\n\t\t\t});\n\t\t}\n\n\t\tif (Type.isDomNode(this.actionPanel.userWrapperElement))\n\t\t{\n\t\t\tDom.clean(this.actionPanel.userWrapperElement);\n\t\t\tthis.delegateToSelector.renderTo(this.actionPanel.userWrapperElement);\n\t\t}\n\t}\n\n\tshowErrors(errors: Array<{ message: string }>): void\n\t{\n\t\tif (!Type.isArrayFilled(errors))\n\t\t{\n\t\t\tif (!Type.isArray(errors))\n\t\t\t{\n\t\t\t\tconsole.error(errors);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\n\t\tconst errorsContainer = document.getElementById('bp-user-processes-errors-container');\n\n\t\tif (errorsContainer)\n\t\t{\n\t\t\tlet errorCounter = 0;\n\t\t\tconst fixStyles = () => {\n\t\t\t\tif (errorCounter > 0)\n\t\t\t\t{\n\t\t\t\t\tDom.style(errorsContainer, { margin: '10px' });\n\t\t\t\t}\n\t\t\t\telse\n\t\t\t\t{\n\t\t\t\t\tDom.style(errorsContainer, { margin: '0px' });\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfor (const error of errors)\n\t\t\t{\n\t\t\t\terrorCounter += 1;\n\n\t\t\t\tconst alert = new Alert({\n\t\t\t\t\ttext: Text.encode(error.message),\n\t\t\t\t\tcolor: AlertColor.DANGER,\n\t\t\t\t\tcloseBtn: true,\n\t\t\t\t\tanimated: true,\n\t\t\t\t});\n\n\t\t\t\talert.renderTo(errorsContainer);\n\n\t\t\t\tif (alert.getCloseBtn())\n\t\t\t\t{\n\t\t\t\t\t// eslint-disable-next-line no-loop-func\n\t\t\t\t\talert.getCloseBtn().onclick = () => {\n\t\t\t\t\t\terrorCounter -= 1;\n\t\t\t\t\t\tfixStyles();\n\t\t\t\t\t};\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tfixStyles();\n\t\t}\n\t}\n\n\tonActionPanelChanged(): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tconst actionPanel = grid?.getActionsPanel();\n\n\t\tif (actionPanel)\n\t\t{\n\t\t\tconst action = actionPanel.getValues()[this.actionPanel.actionButtonName];\n\t\t\tif (!Type.isString(action) || action.includes('set_status'))\n\t\t\t{\n\t\t\t\tDom.hide(this.actionPanel.userWrapperElement);\n\t\t\t}\n\t\t\telse\n\t\t\t{\n\t\t\t\tDom.show(this.actionPanel.userWrapperElement);\n\t\t\t}\n\t\t}\n\t}\n\n\tapplyActionPanelValues(): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tconst actionsPanel = grid?.getActionsPanel();\n\n\t\tif (grid && actionsPanel)\n\t\t{\n\t\t\tconst isApplyingForAll = actionsPanel.getForAllCheckbox()?.checked === true;\n\t\t\t// TODO - implement doing all tasks\n\t\t\tif (isApplyingForAll)\n\t\t\t{\n\t\t\t\tthis.showErrors([{ message: 'Not implemented currently' }]);\n\t\t\t}\n\n\t\t\tconst action: string = actionsPanel.getValues()[this.actionPanel.actionButtonName];\n\n\t\t\tif (Type.isString(action))\n\t\t\t{\n\t\t\t\tconst selectedTasks = this.getSelectedTaskIds(grid.getRows().getSelectedIds());\n\n\t\t\t\tif (selectedTasks.length === 0)\n\t\t\t\t{\n\t\t\t\t\t// todo: show error?\n\n\t\t\t\t\treturn;\n\t\t\t\t}\n\n\t\t\t\tif (action.includes('set_status_'))\n\t\t\t\t{\n\t\t\t\t\tconst status = parseInt(action.split('_').pop(), 10);\n\n\t\t\t\t\tif (Type.isNumber(status))\n\t\t\t\t\t{\n\t\t\t\t\t\tthis.setTasksStatuses(selectedTasks, status);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse if (action.startsWith('delegate_to'))\n\t\t\t\t{\n\t\t\t\t\tthis.delegateTasks(selectedTasks, this.delegateToUserId);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\n\n\tgetSelectedTaskIds(selectedWorkflowIds: Array<WorkflowId>): Array<TaskId>\n\t{\n\t\treturn (\n\t\t\tselectedWorkflowIds\n\t\t\t\t.map((workflowId) => this.#workflowTasks.get(workflowId))\n\t\t\t\t.filter((taskId) => Type.isNumber(taskId))\n\t\t);\n\t}\n\n\tsetTasksStatuses(taskIds: Array<TaskId>, newStatus: number): void\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tajax\n\t\t\t.runAction('bizproc.task.doInlineTasks', {\n\t\t\t\tdata: {\n\t\t\t\t\ttaskIds,\n\t\t\t\t\tnewStatus,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.showErrors(response.errors);\n\t\t\t\tthis.reloadGrid();\n\t\t\t})\n\t\t\t// .then(() => this.reloadGrid())\n\t\t;\n\t}\n\n\tdelegateTasks(taskIds: Array<TaskId>, toUserId: number): void\n\t{\n\t\t// eslint-disable-next-line promise/catch-or-return\n\t\tajax\n\t\t\t.runComponentAction('bitrix:bizproc.user.processes', 'delegateTasks', {\n\t\t\t\tmode: 'class',\n\t\t\t\tdata: {\n\t\t\t\t\ttaskIds,\n\t\t\t\t\ttoUserId,\n\t\t\t\t},\n\t\t\t})\n\t\t\t.catch((response) => {\n\t\t\t\tthis.showErrors(response.errors);\n\t\t\t\tthis.reloadGrid();\n\t\t\t})\n\t\t\t// .then(() => this.reloadGrid())\n\t\t;\n\t}\n\n\treloadGrid(): void\n\t{\n\t\tthis.getGrid()?.reload();\n\t}\n\n\tdoTask(props: {\n\t\ttaskId: TaskId,\n\t\tworkflowId: WorkflowId,\n\t\ttaskName: string,\n\t\ttaskRequest: Object,\n\t}): void\n\t{\n\t\tthis.#hideRow(props.workflowId);\n\n\t\tajax.runAction('bizproc.task.do', {\n\t\t\tdata: props,\n\t\t}).then(() => {\n\t\t\tif (props.taskName)\n\t\t\t{\n\t\t\t\tUI.Notification.Center.notify({\n\t\t\t\t\tcontent: Loc.getMessage(\n\t\t\t\t\t\t'BIZPROC_USER_PROCESSES_TEMPLATE_TASK_TOUCHED',\n\t\t\t\t\t\t{ '#TASK_NAME#': Text.encode(props.taskName) },\n\t\t\t\t\t),\n\t\t\t\t});\n\t\t\t}\n\t\t}).catch((response) => {\n\t\t\tthis.showErrors(response.errors);\n\t\t\tthis.#showRow(props.workflowId);\n\t\t});\n\t}\n\n\tremoveWorkflow(workflowId: string): void\n\t{\n\t\tthis.#hideRow(workflowId, true);\n\t\tthis.#deleteWorkflowRendererById(workflowId);\n\t\tthis.#workflowTasks.delete(workflowId);\n\t}\n\n\tgetGrid(): ?BX.Main.grid\n\t{\n\t\tif (this.gridId)\n\t\t{\n\t\t\treturn BX.Main.gridManager?.getInstanceById(this.gridId);\n\t\t}\n\n\t\t// eslint-disable-next-line no-console\n\t\tconsole.warn('Grid not found');\n\n\t\treturn null;\n\t}\n\n\t#createWorkflowRenderer(workflowId: WorkflowId, workflow): WorkflowRenderer\n\t{\n\t\tthis.#workflowRenderer[workflowId] = new WorkflowRenderer({\n\t\t\tuserProcesses: this,\n\t\t\tcurrentUserId: this.currentUserId,\n\t\t\tworkflow,\n\t\t});\n\n\t\treturn this.#workflowRenderer[workflowId];\n\t}\n\n\t#getWorkflowRendererById(workflowId: WorkflowId): ?WorkflowRenderer\n\t{\n\t\treturn Type.isNil(this.#workflowRenderer[workflowId]) ? null : this.#workflowRenderer[workflowId];\n\t}\n\n\t#deleteWorkflowRendererById(workflowId: WorkflowId)\n\t{\n\t\tconst renderer = this.#getWorkflowRendererById(workflowId);\n\t\tif (renderer)\n\t\t{\n\t\t\trenderer.destroy();\n\t\t\tdelete this.#workflowRenderer[workflowId];\n\t\t}\n\t}\n\n\t#hideRow(id: string, remove: boolean = false): void\n\t{\n\t\tconst grid = this.getGrid();\n\t\tconst row = grid?.getRows().getById(id);\n\n\t\tif (row)\n\t\t{\n\t\t\trow.hide();\n\t\t\tif (remove)\n\t\t\t{\n\t\t\t\tDom.remove(row.getNode());\n\t\t\t}\n\n\t\t\tif (grid.getRows().getCountDisplayed() === 0)\n\t\t\t{\n\t\t\t\tgrid.getRealtime().showStub();\n\t\t\t}\n\t\t}\n\t}\n\n\t#showRow(id: string): void\n\t{\n\t\tthis.getGrid()?.getRows().getById(id)?.show();\n\t}\n}\n"],"names":["WorkflowLoader","loadWorkflows","ids","action","data","Promise","resolve","reject","ajax","runComponentAction","mode","catch","response","then","WorkflowRenderer","constructor","workflow","Type","isNumber","currentUserId","userId","task","Task","isArrayFilled","controls","buttons","setButtons","map","button","onclick","userProcesses","doTask","taskId","id","workflowId","taskName","name","taskRequest","NAME","VALUE","InlineTaskView","responsibleUser","renderProcess","itemName","isString","typeName","documentUrl","url","workflowUrl","description","lengthLimit","collapsedDescription","Dom","create","html","replace","textContent","slice","collapsed","length","Tag","render","Text","encode","toUpperCase","Loc","getMessage","renderTaskName","renderTask","completedClassName","isCompleted","statusText","renderDocumentName","documentName","document","Uri","toString","renderWorkflowFaces","target","WorkflowFaces","targetUserId","taskProgress","showArrow","renderSummary","Summary","time","total","workflowIsCompleted","renderModified","counter","taskCnt","commentCnt","primaryColor","CounterColor","SUCCESS","DANGER","Counter","value","color","secondaryColor","isDouble","getContainer","modified","destroy","isNil","idParam","uri","CounterPanel","options","filterId","counters","renderTo","uiPanel","BX","UI","multiselect","title","items","order","separator","eventsForActive","click","bind","eventsForUnActive","comment","init","PULL","subscribe","moduleId","command","callback","params","taskCounterValue","message","bp_tasks","getItemById","updateValue","updateColor","allUnreadValue","allUnread","presetId","filterManager","api","getApi","fields","SYSTEM_PRESET","setFields","apply","Main","getById","console","warn","UserProcesses","delegateToUserId","Map","mustSubscribeToPushes","isPlainObject","gridId","isArray","errors","showErrors","actionPanel","wrapperElementId","actionPanelUserWrapperId","actionButtonName","loader","initCounterPanel","getDefaultAddRowOptions","renderer","actions","text","href","push","animation","columns","ID","PROCESS","TASK_PROGRESS","TASK","WORKFLOW_STATE","DOCUMENT_NAME","WORKFLOW_TEMPLATE_NAME","templateName","TASK_DESCRIPTION","MODIFIED","WORKFLOW_STARTED","workflowStarted","WORKFLOW_STARTED_BY","startedBy","OVERDUE_DATE","overdueDate","SUMMARY","columnClasses","editable","Boolean","userWrapperElement","getElementById","initUserSelector","renderCells","onActionPanelChanged","panelWrapperNode","querySelector","updated","querySelectorAll","forEach","attr","columnId","has","set","renderColumnCell","String","childNode","initStartWorkflowButton","buttonId","isStringFilled","lists","dataset","JSON","parse","selectedIBlockSliderParams","popupMenu","Menu","angle","offsetLeft","getPosition","width","autoHide","bindElement","closeByEsc","Object","values","list","item","className","iconUrl","icon","iBlockTypeId","iBlockId","analyticsP1","selected","close","Runtime","loadExtension","CreationGuide","open","popupElement","getMenuContainer","iconElement","append","parentElement","event","preventDefault","getPopupWindow","isShown","sendData","tool","category","c_section","c_element","toggle","delegateToSelector","TagSelector","multiple","tagMaxWidth","events","onTagAdd","parseInt","getData","tag","getId","isInteger","onTagRemove","dialogOptions","entities","intranetUsersOnly","inviteEmployeeLink","isDomNode","clean","error","errorsContainer","errorCounter","fixStyles","style","margin","alert","Alert","AlertColor","closeBtn","animated","getCloseBtn","grid","getGrid","getActionsPanel","getValues","includes","hide","show","applyActionPanelValues","actionsPanel","isApplyingForAll","getForAllCheckbox","checked","selectedTasks","getSelectedTaskIds","getRows","getSelectedIds","status","split","pop","setTasksStatuses","startsWith","delegateTasks","selectedWorkflowIds","get","filter","taskIds","newStatus","runAction","reloadGrid","toUserId","reload","props","Notification","Center","notify","content","removeWorkflow","delete","gridManager","getInstanceById","eventName","rowsCollectionWrapper","workflows","gridRealtime","getRealtime","lastWorkflowId","isActual","startedById","insertAfter","addRowOptions","prepend","addRow","row","columnClass","entries","addClass","getCellById","getNode","Event","animationName","removeClass","remove","getCountDisplayed","showStub"],"mappings":"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"}