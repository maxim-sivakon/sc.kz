{"version":3,"file":"widgetvue.bundle.js","sources":["../src/internal/fetch-data.js","../src/components/content.js","../src/components/message.js","../src/components/error.js","../src/widgetvue.js"],"sourcesContent":["import {Backend} from 'landing.backend';\n\nexport default async function fetchData(blockId: number, params: {} = {})\n{\n\tlet data = await Backend.getInstance()\n\t\t.action('RepoWidget::fetchData', {\n\t\t\tblockId,\n\t\t\tparams,\n\t\t})\n\t\t.catch(err => {\n\t\t\tconsole.error(\"Fetch error\", err);\n\t\t});\n\n\ttry\n\t{\n\t\tdata = JSON.parse(data);\n\t\tif (data['error'])\n\t\t{\n\t\t\tconsole.error(\"Fetch data error: data failed\", data['error']);\n\t\t\tdata = {};\n\t\t}\n\t}\n\tcatch(e) {\n\t\tconsole.error(\"Fetch data error: json parse error\");\n\t\tdata = {};\n\t}\n\n\treturn data;\n}\n","import { ref } from 'ui.vue3';\nimport { Type, Loc } from 'main.core';\nimport fetchData from '../internal/fetch-data';\n\nconst fetchAlarmTime = 5000;\n\nexport const Content = {\n\tprops: {\n\t\tdefaultData: {\n\t\t\ttype: Object,\n\t\t\tdefault: null,\n\t\t},\n\t\tblockId: {\n\t\t\ttype: Number,\n\t\t\trequired: true,\n\t\t},\n\t\tappId: {\n\t\t\ttype: Number,\n\t\t\tdefault: 0,\n\t\t},\n\t\tfetchable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t\tclickable: {\n\t\t\ttype: Boolean,\n\t\t\tdefault: false,\n\t\t},\n\t},\n\n\tdata()\n\t{\n\t\treturn {\n\t\t\tisFetching: false,\n\t\t};\n\t},\n\n\tmethods: {\n\t\tfetch(params: {} = {})\n\t\t{\n\t\t\tif (!this.clickable || this.isFetching)\n\t\t\t{\n\t\t\t\tconsole.warn('Events is disabled now');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.appId <= 0 || !this.fetchable)\n\t\t\t{\n\t\t\t\tconsole.warn('If you want fetch external data in widget - you must add application and handler');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tthis.isFetching = true;\n\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:startContentLoad');\n\n\t\t\tconst timeout = setTimeout(() => {\n\t\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:onMessage', {\n\t\t\t\t\tmessage: Loc.getMessage('LANDING_WIDGETVUE_LOADER_TOO_LONG'),\n\t\t\t\t});\n\t\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:endContentLoad');\n\t\t\t}, fetchAlarmTime);\n\n\t\t\tfetchData(this.blockId, params)\n\t\t\t\t.then(data => {\n\t\t\t\t\tclearTimeout(timeout);\n\t\t\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:endContentLoad');\n\t\t\t\t\tthis.$bitrix.eventEmitter.emit('landing:widgetvue:onHideMessage');\n\t\t\t\t\tthis.isFetching = false;\n\n\t\t\t\t\tif (data && Object.keys(data).length > 0)\n\t\t\t\t\t{\n\t\t\t\t\t\tfor (let code in data)\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tif (this[code] !== undefined)\n\t\t\t\t\t\t\t{\n\t\t\t\t\t\t\t\tthis[code] = data[code];\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t},\n\n\t\topenApplication(params: {} = {})\n\t\t{\n\t\t\tif (!this.clickable || this.isFetching)\n\t\t\t{\n\t\t\t\tconsole.info('Events is disabled now');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tif (this.appId <= 0)\n\t\t\t{\n\t\t\t\tconsole.warn('If you want fetch external data in widget - you must add application and handler');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tBX.rest.AppLayout.openApplication(\n\t\t\t\tthis.appId,\n\t\t\t\tparams,\n\t\t\t);\n\t\t},\n\n\t\topenPath(path: string)\n\t\t{\n\t\t\tif (!this.clickable || this.isFetching)\n\t\t\t{\n\t\t\t\tconsole.info('Events is disabled now');\n\t\t\t\treturn;\n\t\t\t}\n\n\t\t\tconst url = new URL(path, window.location.origin);\n\t\t\tif (url.origin === window.location.origin)\n\t\t\t{\n\t\t\t\twindow.open(url.href, '_blank');\n\t\t\t}\n\t\t},\n\t},\n\n\tasync setup(props)\n\t{\n\t\tif (props.appId <= 0 || !props.fetchable)\n\t\t{\n\t\t\tconsole.info('If you want fetch external data in widget - you must add application and handler');\n\t\t\treturn;\n\t\t}\n\n\t\tconst dataRefs = {};\n\t\tif (\n\t\t\tprops.defaultData !== null\n\t\t\t&& Object.keys(props.defaultData).length > 0\n\t\t)\n\t\t{\n\t\t\tfor (let code in props.defaultData)\n\t\t\t{\n\t\t\t\tdataRefs[code] = ref(props.defaultData[code]);\n\t\t\t}\n\n\t\t\tfetchData(props.blockId).then(data => {\n\t\t\t\tif (data && Type.isObject(data))\n\t\t\t\t{\n\t\t\t\t\tfor (let code in data)\n\t\t\t\t\t{\n\t\t\t\t\t\tif (dataRefs[code])\n\t\t\t\t\t\t{\n\t\t\t\t\t\t\tdataRefs[code].value = data[code];\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\n\t\telse\n\t\t{\n\t\t\tconst data = await fetchData(props.blockId);\n\t\t\tfor (let code in data)\n\t\t\t{\n\t\t\t\tdataRefs[code] = ref(data[code]);\n\t\t\t}\n\t\t}\n\n\t\treturn dataRefs;\n\t},\n};\n","import { Loc } from 'main.core';\nimport LoaderImage from '../images/emptystate.svg';\n\nexport const Message = {\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_LOADER_DEFAULT_MESSAGE'),\n\t\t},\n\t\tlink: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tlinkText: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_ERROR_DEFAULT_LINK_TEXT'),\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"w-loader\">\n\t\t\t<div class=\"w-loader-icon\"></div>\n\t\t\t<div class=\"w-loader-text\">\n\t\t\t\t<div>{{message}}</div>\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { Loc } from 'main.core';\nimport ErrorImage from '../images/emptystate-error.svg';\n\nexport const Error = {\n\tprops: {\n\t\tmessage: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_ERROR_DEFAULT_MESSAGE'),\n\t\t},\n\t\tlink: {\n\t\t\ttype: String,\n\t\t\tdefault: null,\n\t\t},\n\t\tlinkText: {\n\t\t\ttype: String,\n\t\t\tdefault: Loc.getMessage('LANDING_WIDGETVUE_ERROR_DEFAULT_LINK_TEXT'),\n\t\t},\n\t},\n\n\ttemplate: `\n\t\t<div class=\"w-error\">\n\t\t\t<div class=\"w-loader-icon --error\"></div>\n\t\t\t<div class=\"w-error-text\">\n\t\t\t\t<div>{{message}}</div>\n\t\t\t\t<a class=\"w-loader-link\" :href=\"link\">linkText: link</a>\t\n\t\t\t</div>\n\t\t</div>\n\t`,\n};\n","import { BitrixVue, VueCreateAppResult } from 'ui.vue3';\nimport { Text, Type, Runtime, Loc } from 'main.core';\nimport { BaseEvent }  from 'main.core.events';\nimport { Loader } from 'main.loader';\n\nimport { Content } from './components/content';\nimport { Message } from './components/message';\nimport { Error } from './components/error';\nimport { WidgetOptions } from './internal/types';\n\nimport './css/style.css';\n\nexport class WidgetVue\n{\n\tstatic runningAppNodes: Set<HTMLElement> = new Set();\n\n\t#rootNode: ?HTMLElement;\n\t#data: ?{};\n\t#blockId: number;\n\t#appId: number;\n\n\t#fetchable: boolean;\n\t#clickable: boolean;\n\t#allowedByTariff: boolean;\n\n\t#application: VueCreateAppResult;\n\t#contentTemplate: Object;\n\n\tconstructor(options: WidgetOptions): void\n\t{\n\t\tthis.#rootNode = Type.isString(options.rootNode) ? document.querySelector(options.rootNode) : null;\n\t\tthis.#data = Type.isObject(options.data) ? options.data : null;\n\n\t\tthis.#blockId = options.blockId ? Text.toNumber(options.blockId) : 0;\n\t\tthis.#appId = options.appId ? Text.toNumber(options.appId) : 0;\n\t\tthis.#contentTemplate = Runtime.clone(Content);\n\n\t\tthis.#fetchable = options.fetchable || false;\n\t\tconst isEditMode = Type.isFunction(BX.Landing.getMode) && BX.Landing.getMode() === 'edit';\n\t\tthis.#clickable = !isEditMode;\n\t\tthis.#allowedByTariff =\n\t\t\t(this.#appId && Type.isBoolean(options.allowedByTariff))\n\t\t\t\t? options.allowedByTariff\n\t\t\t\t: true\n\t\t;\n\t}\n\n\tmount()\n\t{\n\t\tif (\n\t\t\tthis.#blockId > 0\n\t\t\t&& this.#rootNode\n\t\t\t&& !WidgetVue.runningAppNodes.has(this.#rootNode)\n\t\t)\n\t\t{\n\n\t\t\tthis.loader = new Loader({\n\t\t\t\ttarget: this.#rootNode,\n\t\t\t});\n\t\t\t// todo: need<template> ?\n\t\t\tthis.#contentTemplate.template = this.#rootNode.innerHTML || '';\n\t\t\tthis.#createApp();\n\t\t\tWidgetVue.runningAppNodes.add(this.#rootNode);\n\t\t}\n\t}\n\n\tshowLoader()\n\t{\n\t\tthis.loader.show();\n\t}\n\n\thideLoader()\n\t{\n\t\tthis.loader.hide();\n\t}\n\n\t#createApp(): void\n\t{\n\t\tconst context = this;\n\n\t\tthis.#application = BitrixVue.createApp({\n\t\t\tname: 'BX widget ' + this.#blockId,\n\n\t\t\tcomponents: {\n\t\t\t\tMessage,\n\t\t\t\tError,\n\t\t\t\tContent: this.#contentTemplate,\n\t\t\t},\n\n\t\t\tprops: {\n\t\t\t\tdefaultData: {\n\t\t\t\t\ttype: Object,\n\t\t\t\t\tdefault: null,\n\t\t\t\t},\n\n\t\t\t\tallowedByTariff: {\n\t\t\t\t\ttype: Boolean,\n\t\t\t\t\tdefault: true,\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tdata() {\n\t\t\t\treturn {\n\t\t\t\t\tmessage: null,\n\t\t\t\t\terror: null,\n\t\t\t\t};\n\t\t\t},\n\n\t\t\tcreated()\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:startContentLoad', this.onShowLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:endContentLoad', this.onHideLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:onMessage', this.onShowMessage);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:onHideMessage', this.onHideMessage);\n\t\t\t\tthis.$bitrix.eventEmitter.subscribe('landing:widgetvue:onError', this.onShowError);\n\t\t\t},\n\n\t\t\tbeforeUnmount()\n\t\t\t{\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:startContentLoad', this.onShowLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:endContentLoad', this.onHideLoader);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:onMessage', this.onShowMessage);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:onHideMessage', this.onHideMessage);\n\t\t\t\tthis.$bitrix.eventEmitter.unsubscribe('landing:widgetvue:onError', this.onShowError);\n\t\t\t},\n\n\t\t\tmethods: {\n\t\t\t\tonShowLoader()\n\t\t\t\t{\n\t\t\t\t\t// todo: move loader to comp\n\t\t\t\t\tthis.$bitrix.Application.get().showLoader();\n\t\t\t\t},\n\n\t\t\t\tonHideLoader()\n\t\t\t\t{\n\t\t\t\t\t// todo: move loader to comp\n\t\t\t\t\tthis.$bitrix.Application.get().hideLoader();\n\t\t\t\t},\n\n\t\t\t\tonShowMessage(event: BaseEvent)\n\t\t\t\t{\n\t\t\t\t\tconst message = event.getData()?.message || null;\n\t\t\t\t\tthis.message = {\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t};\n\t\t\t\t},\n\n\t\t\t\tonHideMessage()\n\t\t\t\t{\n\t\t\t\t\tthis.message = null;\n\t\t\t\t},\n\n\t\t\t\tonShowError(event: BaseEvent)\n\t\t\t\t{\n\t\t\t\t\tconst message = event.getData()?.message || null;\n\t\t\t\t\tthis.error = {\n\t\t\t\t\t\tmessage: message,\n\t\t\t\t\t};\n\t\t\t\t},\n\t\t\t},\n\n\t\t\tbeforeCreate(): void\n\t\t\t{\n\t\t\t\tthis.$bitrix.Application.set(context);\n\t\t\t},\n\n\t\t\ttemplate: `\n\t\t\t\t<Error\n\t\t\t\t\tv-if=\"!allowedByTariff\"\n\t\t\t\t\tmessage=\"${Loc.getMessage('LANDING_WIDGETVUE_ERROR_PAYMENT')}\"\n\t\t\t\t>\n\t\t\t\t</Error>\n\n\t\t\t\t<Suspense v-else>\n\t\t\t\t\t<template #default>\n\t\t\t\t\t\t<div>\n\t\t\t\t\t\t\t<Error\n\t\t\t\t\t\t\t\tv-show=\"error !== null\"\n\t\t\t\t\t\t\t\tv-bind=\"error && error.message !== null ? { \n\t\t\t\t\t\t\t\t\tmessage: error.message \n\t\t\t\t\t\t\t\t} : {}\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Message\n\t\t\t\t\t\t\t\tv-show=\"message !== null\"\n\t\t\t\t\t\t\t\tv-bind=\"message && message.message !== null ? { \n\t\t\t\t\t\t\t\t\tmessage: message.message \n\t\t\t\t\t\t\t\t} : {}\"\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t\t<Content\n\t\t\t\t\t\t\t\tv-show=\"message === null && error === null\"\n\n\t\t\t\t\t\t\t\t:defaultData=\"defaultData\"\n\t\t\t\t\t\t\t\t:blockId=${this.#blockId}\n\t\t\t\t\t\t\t\t:appId=\"${this.#appId}\"\n\t\t\t\t\t\t\t\t:fetchable=${this.#fetchable}\n\t\t\t\t\t\t\t\t:clickable=${this.#clickable}\n\t\t\t\t\t\t\t/>\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</template>\n\n\t\t\t\t\t<template #fallback>\n\t\t\t\t\t\t<Message\n\t\t\t\t\t\t\tmessage=\"${Loc.getMessage('LANDING_WIDGETVUE_LOADER_DEFAULT_MESSAGE')}\"\n\t\t\t\t\t\t/>\n\t\t\t\t\t</template>\n\t\t\t\t</Suspense>\n\t\t\t`,\n\t\t},\n\t\t{\n\t\t\tdefaultData: this.#data,\n\t\t\tallowedByTariff: this.#allowedByTariff,\n\t\t});\n\n\t\tthis.#application.mount(this.#rootNode);\n\t}\n}"],"names":["fetchData","blockId","params","data","Backend","getInstance","action","catch","err","console","error","JSON","parse","e","fetchAlarmTime","Content","props","defaultData","type","Object","default","Number","required","appId","fetchable","Boolean","clickable","isFetching","methods","fetch","warn","$bitrix","eventEmitter","emit","timeout","setTimeout","message","Loc","getMessage","then","clearTimeout","keys","length","code","undefined","openApplication","info","BX","rest","AppLayout","openPath","path","url","URL","window","location","origin","open","href","setup","dataRefs","ref","Type","isObject","value","Message","String","link","linkText","template","Error","WidgetVue","constructor","options","isString","rootNode","document","querySelector","Text","toNumber","Runtime","clone","isEditMode","isFunction","Landing","getMode","isBoolean","allowedByTariff","mount","runningAppNodes","has","loader","Loader","target","innerHTML","add","showLoader","show","hideLoader","hide","context","BitrixVue","createApp","name","components","created","subscribe","onShowLoader","onHideLoader","onShowMessage","onHideMessage","onShowError","beforeUnmount","unsubscribe","Application","get","event","getData","beforeCreate","set","Set"],"mappings":"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"}